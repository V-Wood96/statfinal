---
title: "FINAL CODE"
editor: visual
---
# https://www.irs.gov/charities-non-profits/exempt-organizations-business-master-file-extract-eo-bmf
## Cleaning The Data


eo.pr <- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo_pr.csv')

eo.xx <- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo_xx.csv')

eo1<- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo1 (1).csv')

eo2 <- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo2.csv')

eo3 <- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo3.csv')

eo4 <- read.csv('/Users/veronicawood/School/GM Fall 2025 /STAT 515 - Applied Statistics and Visualization for Analytics/Final project/eo4.csv')

library(dplyr)

# We first combind the different region 

big_df <- bind_rows(eo.pr, eo.xx, eo1, eo2, eo3, eo4)

tax.all <- big_df %>%
  filter(!is.na(INCOME_AMT),
         INCOME_AMT > 0)


states_50 <- state.abb

tax.all <- tax.all %>%
  filter(STATE %in% states_50)

tax.all$TaxDate <- as.Date(
  paste0(tax.all$TAX_PERIOD, "01"),  
  format = "%Y%m%d")

cutoff <- as.Date("2021-01-01")

tax.all <- tax.all %>%
  filter(TaxDate >= cutoff)

table(floor(tax.all$TAX_PERIOD / 100))

tax.2024 <- tax.all %>%
  filter(floor(TAX_PERIOD / 100) == 2024)





## Research Question One 


tax.2024$GroupStatus <- ifelse(tax.2024$GROUP == 0,
                               "Standalone", "GroupAffiliated")
tax.2024$GroupStatus <- factor(tax.2024$GroupStatus)

median_income_2024 <- median(tax.2024$INCOME_AMT, na.rm = TRUE)

tax.2024$HighIncome <- ifelse(tax.2024$INCOME_AMT > median_income_2024,
                              "High", "Low")
tax.2024$HighIncome <- factor(tax.2024$HighIncome,
                              levels = c("Low","High"))
                              


## Research Question Two 
## Research Question Three 
## Research Question Four
## Research Question Five